# name: test/sql/secrets/secrets_encryption.test
# description: Test secret creation for internal encryption
# group: [simple-encryption/secrets]

statement ok
PRAGMA enable_verification;

require simple_encryption

# Ensure any currently stored secrets don't interfere with the test
statement ok
set allow_persistent_secrets=false;

# Create an internal secret (for internal encryption of columns)
statement ok
CREATE SECRET test_key (
	TYPE ENCRYPTION,
    KEY_NAME 'key_1',
    KEY_VALUE '0123456789112345',
    LENGTH 16
);

# Create an internal secret (for internal encryption of columns)
statement error
CREATE SECRET test_wrong_length (
	TYPE ENCRYPTION,
    KEY_NAME 'key_1',
    KEY_VALUE '0123456789112345',
    LENGTH 99
);
----
Invalid Input Error: Invalid size for encryption key: '99', expected: 16, 24, or 32

statement ok
SELECT encrypt(11, '0123456789112345');